---
title: Dependabot をちゃんと活用するために行なった取り組み
date: '2022-10-30'
---

Dependabot 溜めてました。

反省して、Dependabot を活用するため色々試してみたので、それについてまとめます。

## 1. Dependabot 用の時間を作る

月の初めに Dependabot のマージに取り組む、と決めてしまいました。

## 2. レビュアー・マイルストーンの自動設定

レビュアーに自分が設定されているとレビューしなきゃってなりますよね。
マイルストーンに日付が設定されていると時間内にやろうって気になりますよね。多分。

ということで以下のように設定しました。

| 項目           | 値                                    |
| -------------- | ------------------------------------- |
| レビュアー     | 全員                                  |
| マイルストーン | `security-update-<month>` (毎月 8 日) |

意識したのは、レビュアーを最大限に設定することです。**人の目は出来るだけ増やすという方針を明示しました**。ただし、チームの体質によっては、レビューがお見合いになる可能性はあります。

また、自動設定の方法は、リポジトリごとに Github Actions を設定するのが大変だったので、Dependabot 対策用のリポジトリを一つ作ってそこから、API を叩いて設定することにしました。

## 3. TODO リストを作る

その月に取り組む Dependabot の PR を Issue に TODO リストとしてまとめるようにしました。これによって、**全体像が把握でき、振り返りをしやすくなる**のではという算段です。

## 4. ルールを明言する

Dependabot をチームで取り組むために統一されたルールを用意しました。

- Dependabot には**メジャーバージョン**のアップデートも含まれることに注意する
  - ほとんどのライブラリは最新のメジャーバージョンでセキュリティアップデートを行なっています
- メジャーバージョン・マイナーバージョンは**テスト**を実行する
- パッチバージョンは**リリースノート**を確認する
- 以前アップデートにより不具合が起きたものは、**注意するリストに記録**しておく

## 5. Dependabot の PR の量を必要最小限にする

静的サイトジェネレータに関するライブラリは、**ユーザーの入力を受けないので**、リスクが低いと判断して、今回はスキップしました。

---

以上、取り組みでした。今後の課題としては、

- アップデートされるバージョンの種類によって CI の実行内容を変えたい
- たくさんレビューしたで賞を設けたい

です。ありがとうございました。
