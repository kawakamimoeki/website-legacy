---
title: 非構造化データ検索の台頭と、LLM時代における構造化データ検索への対応
date: '2023-05-08'
---

## ベクトルデータベースとは？

複雑なデータは急速なペースで増えている。これらは、文書、画像、動画、ウェブ上のプレーンテキストなど、構造化されていないデータの形態を含んでいる。

多くの組織は、複雑なデータの保存と分析を必要としているが、複雑なデータは、構造化されたデータを念頭に置いて構築された従来のデータベースでは扱いが難しい場合がある。キーワードやメタデータのみで複雑なデータを分類することは、そのさまざまな特性を十分に表現するには不十分かもしれないと考えている。

幸いなことに、機械学習（ML）技術は、ベクトル埋め込みに変換することで、複雑なデータのはるかに有益な表現を提供できる。ベクトル埋め込みは、数百または数千の異なる次元で数値として複雑なデータオブジェクトを記述する。ベクトルデータベースは、ベクトル埋め込みのユニークな構造を処理するために特別に作られていて、ベクターをインデックス化し、値を比較して互いに最も類似したものを見つけることで、簡単に検索や取得ができる。

## 機械学習の台頭により、ベクトル検索は構造化されたデータ検索よりも強力に

OpenAI API のリリースや、Langchain のようなツール、Pinecone のようなベクトル DB サービスの登場により、ベクトル検索の利用がこれまで以上に手軽になった。

過去数ヶ月で、多くの人が非構造化データを使い始め、実験を重ねている。

では、構造化データについてはどうだろう？

Langchain のような LLM ツールチェーンによって紹介されている方法は、言語モデルが SQL クエリを生成する方法だ。

これは一見素晴らしいように見えるが、実際に試してみると、単にゲームのコントローラーを有線から無線に変更するようなもので、画面上の実際のゲーム映像はまったく変わらない。かなり自然な検索結果を返すと思われるベクトル検索とは対照的に、リレーショナルデータベース検索は時代に取り残されてしまったようだ。

ただし、厳密な検索のための構造化であって、単純に自然言語に十分に対応していないというのは誤りではないと言う人がいるのは予想できる。

それは本当にそうだろうか。

## メインの非構造化データ（文書）とそれに関連する構造的な関連性（例えば時間/人物）

この問題で最も影響があるのは、組織内ドキュメントや業務メッセージだ。これは、文書やメッセージ自体が強い非構造化の側面を持っている一方で、いつ更新されたのか、誰が書いたのかという情報を常に含んでいるため、非構造化と構造化の両方の視点が必要。

もちろん、Web のように文書自体に日付や著者情報が含まれる可能性が高い場合はあまり問題ではないが、問題は、RDB で完全に管理されている組織内の文書やチャットで起きる。

## 解決策の案

このドキュメントやチャットの問題に対処するため、以下の暫定的な対策を踏むことにした。ベクトル化されるテキストに関連情報を埋め込む。

従来のテキスト:

```
これは意味のありそうな文章だ。
```

解決するためのテキスト案:

```
タイトル: 意味のありそうな文書
著者: 山田太郎
更新日: 2023-04-16
本文: これは意味のありそうな文章だ。
```

私の実験では、「誰がどの情報に精通しているか」、「重複した内容についてどの情報が正しいか」といった質問に対して、適切な回答が得られた。

---

これは提案です。皆さんの意見をお聞かせいただきたい。
